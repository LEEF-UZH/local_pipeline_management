#!/bin/bash

usage="
Usage: `basename $0` [options] source target_directory
       
Download the 'source' directory or file on the pipeline server
to the target_directory. 
The target_directory will be created if it does not exist.

Options:
  -h, --help            Print short help message and exit
"

if [[ "$1" == "-h" ]] || [[ "$1" == "--help" ]]; then
  echo "${usage}"
  exit 0
fi

############
############

FROM=/mnt/leef_data/$1
TO=./$2

USER=ubuntu
SERVER=$($(dirname "$0")/server)

echo
echo Pipeline Sever is at $SERVER
echo

echo
echo FROM DIR: $FROM
echo USER    : ubuntu
echo SERVER  : 172.23.57.181
echo COMPETE : $USER@$SERVER:$FROM
echo TO DIR  : $TO
echo 

############
############

mkdir -p $TO

rsync --verbose --archive --recursive --compress --info=progress2 -e ssh ubuntu@leef_pipeline:$FROM/ $TO/
  
